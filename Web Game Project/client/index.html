<html>


  <head>
    <link rel="stylesheet" type="text/css" href="client/main.css">
  </head>
  <body>

    <main>
      <!- Container and overlay for the screen ->
      <div id="canvasC">
      <div id="canvasO">

      <canvas id="ctx" width="720" height="670" style="border:5px solid #000000"></canvas>
      </div>
      </div>

      <!- Container for buttons on the left side ->
      <div id="leftbuttonC">
        <div id="startC"> <h5 class="buttontext">START</h5> </div>
        <div id="leaderC"> <h5 class="buttontext"> LEADERBOARD </h5> </div>
      </div>

      <!- container for right side leader board ->
      <div id="rightsideC">
        <img  id="trophyimg" src="client/trophy.png"> </img>
        <div id="currentchamp">
          <h5 class="buttontext"> CURRENT CHAMP </h5>
        </div>


      </div>



    </main>

    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>


    <script>
      var ctx = document.getElementById("ctx").getContext("2d");
      ctx.font = '30px Arial';
      var socket = io();

      socket.on('newPositions',function(data){
          ctx.clearRect(0,0,500,500);
          for(var i = 0 ; i < data.player.length; i++)
              ctx.fillText(data.player[i].number,data.player[i].x,data.player[i].y);

          for(var i = 0 ; i < data.bullet.length; i++)
              ctx.fillRect(data.bullet[i].x-5,data.bullet[i].y-5,10,10);
      });

      document.onkeydown = function(event){
          if(event.keyCode === 68)    //d
              socket.emit('keyPress',{inputId:'right',state:true});
          else if(event.keyCode === 83)   //s
              socket.emit('keyPress',{inputId:'down',state:true});
          else if(event.keyCode === 65) //a
              socket.emit('keyPress',{inputId:'left',state:true});
          else if(event.keyCode === 87) // w
              socket.emit('keyPress',{inputId:'up',state:true});

      }
      document.onkeyup = function(event){
          if(event.keyCode === 68)    //d
              socket.emit('keyPress',{inputId:'right',state:false});
          else if(event.keyCode === 83)   //s
              socket.emit('keyPress',{inputId:'down',state:false});
          else if(event.keyCode === 65) //a
              socket.emit('keyPress',{inputId:'left',state:false});
          else if(event.keyCode === 87) // w
              socket.emit('keyPress',{inputId:'up',state:false});
      }


      document.onmousedown = function(event){
          socket.emit('keyPress',{inputId:'attack',state:true});
          }
      document.onmouseup = function(event){
          socket.emit('keyPress',{inputId:'attack',state:false});
          }
      document.onmousemove = function(event){
          var x = -250 + event.clientX - 8;
          var y = -250 + event.clientY - 8;
          var angle = Math.atan2(y,x) / Math.PI * 180;
          socket.emit('keyPress',{inputId:'mouseAngle',state:angle});
          }

  </script>
  </body>
</html>
